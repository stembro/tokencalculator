'use strict';$(document).ready(function(){(function(c){function e(s){p.icosBox.innerHTML=null,s.sort(function(u,v){return u.toLowerCase().localeCompare(v.toLowerCase())}),s.reverse(),s.forEach(function(u){var v=document.createElement('option');v.text=v.value=u,p.icosBox.add(v,0)});var t=document.createElement('option');t.text=t.value='Select ICO',p.icosBox.add(t,0),p.icosBox.selectedIndex='0'}function f(){return fetch(o.googleICOSheet).then(function(s){return s.text()}).then(function(s){return JSON.parse(s.match(/\((.*)\);/)[1])}).then(function(s){return s.feed.entry.reduce(function(t,u){return t.push(Object.keys(u).filter(function(v){return-1!==v.indexOf('gsx$')}).reduce(function(v,w){return v[w.replace('gsx$','')]=u[w].$t,v},{})),t},[])})}function h(){return fetch(o.currencyExchange).then(function(s){return s.json()}).then(function(s){r=s})}function j(s,t){var u='USD'===t?1:r.rates[t];return fetch(o.ethereumCoinmarketCap).then(function(w){return w.json()}).then(function(w){return s/u/w[0].price_usd})}function k(s,t,u){for(var w=0,x='',y=q.map(function(z){return z}),v=0;v<Object.keys(y).length;v++)if(y[v].companyname===t){if(x=y[v].tokenname,u&&!y[v]['minpre-saletokensforoneeth'])return void alert('Oops, we are sorry! No pre-sale Data is available for '+t+' at the moment.');w=u&&y[v]['minpre-saletokensforoneeth']?parseInt(y[v]['minpre-saletokensforoneeth'])*s:parseInt(y[v].minimumcrowdsaletokensforoneeth)*s;break}return{tokenCount:w.toFixed(2),tokenName:x}}function l(){p.resultBox.value='Loading...';var s=p.amountBox.value,t=!p.icosBox.selectedIndex||!p.currencyBox.selectedIndex||!p.roundBox.selectedIndex;if(t||0>=s)return alert('Oops! Could not Calculate Tokens. Please input all fields in the calculator and make sure the investment amount is a positive number then try again. Click OK to continue.'),void(p.resultBox.value='');var u=p.icosBox.options[p.icosBox.selectedIndex].text,v=!1,w=p.currencyBox.options[p.currencyBox.selectedIndex].text;w=w.substring(0,w.indexOf(' ')).trim(),2===p.roundBox.selectedIndex&&(v=!0);j(s,w).then(function(x){var y=k(x,u,v);p.resultBox.value=y?y.tokenCount+' '+y.tokenName+' Tokens':'Please try again.'}).catch(function(){p.resultBox.value='Please try again.'})}function m(){0<p.amountBox.value&&0!=p.icosBox.selectedIndex&&0!=p.roundBox.selectedIndex&&0!=p.currencyBox&&l()}var o=c.api,p=c.ui,q=[],r=[];(function(){['USD ($)','CAD ($)','EUR (\u20AC)','CNY (\xA5)','KRW (\u20A9)','GBP (\xA3)','JPY (\xA5)'].forEach(function(v,w){var x=document.createElement('option');x.text=x.value=v,p.currencyBox.add(x,w+1)}),p.currencyBox.selectedIndex='0';var t=document.createElement('option');t.text=t.value='Crowdsale';var u=document.createElement('option');u.text=u.value='Pre-Sale',p.roundBox.add(t,1),p.roundBox.add(u,2),p.roundBox.selectedIndex='0'})(),function(){return h().then(f).then(function(s){q=s,e(s.map(function(t){return t.companyname}))})}(),p.calculateButton.addEventListener('click',l),p.icosBox.addEventListener('change',m),p.currencyBox.addEventListener('change',m),p.roundBox.addEventListener('change',m),p.amountBox.addEventListener('change',function(){p.amountBox.value&&p.resultBox.value&&l()})})({api:{currencyExchange:'https://api.fixer.io/latest?base=USD',ethereumCoinmarketCap:'https://api.coinmarketcap.com/v1/ticker/ethereum/',googleICOSheet:'https://spreadsheets.google.com/feeds/list/1y_Rg6i0Yu_uqJ8EqPbwWqlA75f-w84aH3nJ_QiKrbsQ/1/public/values?alt=json-in-script&callback=cb'},ui:{icosBox:document.querySelector('#icos'),currencyBox:document.querySelector('#currencies'),roundBox:document.querySelector('#rounds'),amountBox:document.querySelector('#investmentamount'),resultBox:document.querySelector('#tokensresult'),calculateButton:document.querySelector('#startTokenCalc')}})});